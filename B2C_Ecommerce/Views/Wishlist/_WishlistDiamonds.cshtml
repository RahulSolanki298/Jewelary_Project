@model Models.WishlistModel
@using Common;

@{
    var priImg = string.Empty;
    var secImg = string.Empty;
}
<style>
    .product-main-box {
        border: 1px solid #eee;
        border-radius: 10px;
        background-color: #fff;
        transition: box-shadow 0.3s;
    }

        .product-main-box:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

    .product-thumb {
        height: 400px;
        position: relative;
        overflow: hidden;
    }

        .product-thumb img {
            object-fit: cover;
            width: 100%;
            height: 100%;
            transition: opacity 0.4s ease;
        }

        .product-thumb .sec-img {
            opacity: 0;
        }

        .product-thumb:hover .sec-img {
            opacity: 1;
        }

        .product-thumb:hover .pri-img {
            opacity: 0;
        }

    .product-caption {
        font-size: 14px;
    }

    .transition {
        transition: all 0.4s ease-in-out;
    }
</style>

<div class="container-fluid">
    <div class="row" id="MyProductsImg">
       

            @if (Model?.Jewelleries != null && Model.Jewelleries.Any())
            {
                foreach (var item in Model.Jewelleries)
                {
                    if (item == null) continue;

                    var images = item.ProductImageVideos?
                        .Where(x => !string.IsNullOrEmpty(x.ImageUrl) && x.ImageUrl != "-")
                        .OrderBy(x => x.DisplayOrder)
                        .ToList();

                    priImg = images?.FirstOrDefault()?.ImageUrl ?? "assets/img/no-image-icon-23489.png";
                    secImg = images?.Skip(1).FirstOrDefault()?.ImageUrl ?? priImg;

                    var productFirst = item.ProductItems?.FirstOrDefault();

                    <div class="col-xxl-3 col-xl-4 col-lg-4 col-md-6 mb-4">
                        <div class="product-main-box h-100">
                            <input type="hidden" class="product-id" value="@item.Id" />
                            <div class="product-item">
                                <figure class="product-thumb product-box-with-border media-container position-relative">
                                    <a class="img-with-bg d-block overflow-hidden position-relative" href="@Url.Action("ProductDetails", "Products", new { groupId = item.GroupId, productKey = item.ProductKey })">
                                        <img class="pri-img media-item img-fluid transition" src="@($"{SD.ImgUrl}/{priImg}")" alt="Primary" />
                                        <img class="sec-img media-item img-fluid transition position-absolute top-0 start-0 w-100 h-100" src="@($"{SD.ImgUrl}/{secImg}")" alt="Secondary" />
                                    </a>
                                    <button type="button" class="btn-close position-absolute top-0 end-0 m-2 remove-product" aria-label="Remove" data-productId="@item.Id"></button>
                                </figure>

                                <div class="product-caption text-center product-box-desc px-2 py-3">
                                    <h6 class="mb-1 fw-semibold">@(productFirst?.Title ?? item.Title)</h6>
                                    <div class="text-muted mb-2 small">$@item.Price USD</div>
                                    <a href="@Url.Action("ProductDetails", "Products", new { groupId = item.GroupId })" class="btn btn-dark btn-outline-dark">View Detail</a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }

            @* Wishlist - Diamond *@
            @if (Model?.Diamonds != null && Model.Diamonds.Any())
            {
                foreach (var item in Model.Diamonds)
                {
                    var hasImage = !string.IsNullOrEmpty(item.DiamondImagePath);
                    var hasVideo = !string.IsNullOrEmpty(item.DiamondVideoPath);

                    <div class="col-xxl-3 col-xl-4 col-lg-4 col-md-6 mb-4">
                        <div class="product-main-box h-100">
                            <input type="hidden" class="product-id" value="@item.Id" />
                            <div class="product-item">
                                <figure class="product-thumb product-box-with-border media-container position-relative">
                                    <a class="img-with-bg d-block overflow-hidden" href="@Url.Action("GetSingleDiamond", "Diamond", new { diamondId = item.Id })">
                                        @if (hasImage)
                                        {
                                            <img class="pri-img media-item img-fluid" src="@item.DiamondImagePath" alt="Diamond" style="height: 280px; object-fit: cover;" />
                                        }
                                        else if (hasVideo)
                                        {
                                            <iframe src="@item.DiamondVideoPath" class="w-100" style="height: 350px;" frameborder="0" allowfullscreen></iframe>
                                        }
                                        else
                                        {
                                            <img src="~/assets/img/no-image-icon-23489.png" class="pri-img media-item img-fluid" style="height: 280px; object-fit: cover;" />
                                        }
                                    </a>
                                    <button type="button" class="btn-close position-absolute top-0 end-0 m-2 remove-diamond" aria-label="Remove" data-diamondId="@item.Id"></button>
                                </figure>

                                <div class="product-caption text-center product-box-desc px-2 py-3">
                                    <h6 class="mb-1 fw-semibold">
                                        @item.Carat Carat • @item.ShapeName • @item.ColorName • @item.ClarityName • @item.LabName
                                    </h6>
                                    <div class="text-muted mb-2 small">$@item.Price USD</div>
                                    <a href="@Url.Action("GetSingleDiamond", "Diamond", new { diamondId = item.Id })" class="btn btn-dark btn-outline-dark">View Detail</a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
       
    </div>
</div>