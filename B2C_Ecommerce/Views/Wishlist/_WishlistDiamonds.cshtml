@model Models.WishlistModel
@using Common;

@{
    var priImg = string.Empty;
    var secImg = string.Empty;
}

<div class="shop-main-wrapper py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col text-center mb-4">
                <h2 class="fw-bold">Your Wishlist</h2>
                <hr class="w-25 mx-auto" />
            </div>
        </div>

        @if (Model != null && ((Model?.Jewelleries?.Any() ?? false) || (Model?.Diamonds?.Any() ?? false)))
        {
        <div class="row g-4">
            @* Jewelry Items *@
            @if (Model?.Jewelleries != null && Model.Jewelleries.Any())
                {
                    @foreach (var item in Model.Jewelleries)
                    {
                        if (item == null) continue;

                        var images = item.ProductImageVideos
                            ?.Where(x => !string.IsNullOrEmpty(x.ImageUrl) && x.ImageUrl != "-")
                            .OrderBy(x => x.DisplayOrder)
                            .ToList();

                        priImg = images?.FirstOrDefault()?.ImageUrl ?? "assets/img/no-image-icon-23489.png";
                        secImg = images?.Skip(1).FirstOrDefault()?.ImageUrl ?? priImg;
            <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                <div class="card shadow-sm h-100 border-0">
                    <div class="position-relative">
                        <a href="@Url.Action("ProductDetails", "Products", new { groupId = item.GroupId,productKey=item.ProductKey })">
                            <img src="@($"{SD.ImgUrl}/{priImg}")" class="card-img-top img-fluid" alt="@item.Title" style="height: 280px; object-fit: cover;" />
                        </a>
                        <button type="button" class="btn-close position-absolute top-0 end-0 m-2 remove-product" aria-label="Remove" data-productId="@item.Id"></button>
                    </div>
                    <div class="card-body text-center">
                        <h6 class="fw-semibold">@item.Title</h6>
                        <div class="text-muted mb-2">$@item.Price USD</div>
                        <a href="@Url.Action("ProductDetails", "Products", new { groupId = item.GroupId })" class="btn btn-outline-dark btn-sm">View Detail</a>
                    </div>
                </div>
            </div>
                    }
                }

            @* Diamond Items *@
            @if (Model?.Diamonds != null && Model.Diamonds.Any())
                {
                    foreach (var item in Model.Diamonds)
                    {
            <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                <div class="card shadow-sm h-100 border-0">
                    <div class="position-relative">
                        <a href="@Url.Action("GetSingleDiamond", "Diamond", new { diamondId = item.Id })">
                            @if (!string.IsNullOrEmpty(item.DiamondImagePath))
                                {
                            <img src="@item.DiamondImagePath" class="card-img-top img-fluid" alt="Diamond Image" style="height: 280px; object-fit: cover;" />
                                }
                                else if (!string.IsNullOrEmpty(item.DiamondVideoPath))
                                {
                            <iframe src="@item.DiamondVideoPath" class="w-100" style="height: 280px;" frameborder="0" allowfullscreen></iframe>
                                }
                                else
                                {
                            <img src="~/assets/img/no-image-icon-23489.png" class="card-img-top img-fluid" alt="No Image" style="height: 280px; object-fit: cover;" />
                                }
                        </a>
                        <button type="button" class="btn-close position-absolute top-0 end-0 m-2 remove-diamond" aria-label="Remove" data-diamondId="@item.Id"></button>
                    </div>
                    <div class="card-body text-center">
                        <p class="mb-1 small text-muted">
                            @item.Carat Carat • @item.ShapeName • @item.ColorName • @item.ClarityName • @item.LabName
                        </p>
                        <div class="text-muted mb-2">$@item.Price USD</div>
                        <a href="@Url.Action("GetSingleDiamond", "Diamond", new { diamondId = item.Id })" class="btn btn-outline-dark btn-sm">View Detail</a>
                    </div>
                </div>
            </div>
                    }
                }
        </div>
        }
        else
        {
        <div class="row justify-content-center">
            <div class="col-md-6 text-center py-5">
                <img src="~/assets/img/empty-wishlist.svg" class="img-fluid mb-4" alt="Empty Wishlist" style="max-width: 200px;" />
                <h4 class="text-muted">Your wishlist is empty</h4>
                <p class="text-secondary">Looks like you haven’t added anything yet.</p>
                <a href="@Url.Action("Index", "Products")" class="btn btn-primary px-4 py-2 mt-3">
                    <i class="fa fa-shopping-bag me-2"></i> Start Shopping
                </a>
            </div>
        </div>
        }
    </div>
</div>
